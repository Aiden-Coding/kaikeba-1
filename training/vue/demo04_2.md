### 你怎么理解 vue 中的 diff 算法？

` Author rise created on 2020/1/26 `

- 源码分析1: 必要性,`lifecycle.js` - `mountComponent()`  
组件中可能存在很多个`data`中的key使用
- 源码分析2: 执行方式,`patch.js` - `patchVnode()`  
`patchVnode`是`diff`发生的地方,整体策略:深度优先,同层比较
- 源码分析3: 高效性,`patch.js` - `updateChildren()`  


**总结**
1. `diff算法`是`虚拟DOM`技术的必然产物:通过新旧虚拟DOM做对比(即`diff`),将变化的地方更新在真实的`DOM`上;另外,也需要`diff`高效地执行对比过程,从而降低时间复杂度为`O(n)`

2. Vue 2.x中为了降低`Watcher`的粒度,每个组件只有一个`Watcher`与之对应,只有引入`diff`才能精确找到发生变化的地方

3. `Vue`中`diff`执行的时刻是组件实例执行其更新函数时,它会对比上一次对比结果`oldVnode`和新的渲染结果`newVnode`,此过程称为`patch`

4. `diff`整体过程,遵循深度优先,同层比较的策略;两个节点之间的比较 会根据它们是否拥有子节点或文本节点做不同操作;比较两组子节点是算法的重点;  
首先假设头尾节点可能相同做4次对比尝试,如果没有找到相同节点才按照通用方式遍历查找,查找结束再按情况处理剩下的节点;  
借助`key`通常可以非常精确地找到相同节点,因此整个`patch`过程非常高效
